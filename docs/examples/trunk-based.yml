# yaml-language-server: $schema=../../gitsemver-schema.json
# Trunk-Based Development
#
# Mode: Mainline — aggregate increment, commit count in metadata
#
# Branches: main (trunk) + short-lived feature branches
# No develop, no release branches. Features merge directly to main.
#
# Version examples:
#   main (after v1.0.0, 5 commits with a feat:):
#     1.1.0+5
#
#   main (after v1.0.0, 3 fix commits):
#     1.0.1+3
#
#   feature/auth (from main v1.0.0):
#     1.1.0-auth.1+2
#
# How Mainline mode works:
#   1. Find the latest semver tag on the branch
#   2. Collect all commits since that tag
#   3. Scan messages for the HIGHEST increment (conventional commits / bump directives)
#   4. Apply that increment ONCE
#   5. Commit count since tag → build metadata
#
# To force a version jump:
#   - Tag manually: git tag v2.0.0
#   - Use bump directive: "bump major" in a commit message
#   - Use conventional commit: "feat!: breaking change"

mode: Mainline
tag-prefix: '[vV]'
commit-message-convention: both

branches:
  main:
    regex: ^master$|^main$
    increment: Patch
    tag: ''
    is-mainline: true
    source-branches: [release, hotfix]

  feature:
    regex: ^features?[/-]
    increment: Inherit
    tag: '{BranchName}'
    source-branches: [main]

  hotfix:
    regex: ^hotfix(es)?[/-]
    increment: Patch
    tag: beta
    source-branches: [main]

  pull-request:
    regex: ^(pull|pull-requests|pr)[/-]
    increment: Inherit
    tag: PullRequest
    tag-number-pattern: '[/-](?<number>\d+)'
    source-branches: [main, feature, hotfix]

  # Catch-all: any branch not matching above is treated like a feature branch
  unknown:
    regex: .*
    increment: Inherit
    tag: '{BranchName}'
    source-branches: [main]
